{"remainingRequest":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\src\\views\\MDS\\MDS_import\\MDS_import_form.vue?vue&type=style&index=0&id=7ffe8801&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\src\\views\\MDS\\MDS_import\\MDS_import_form.vue","mtime":1616052285154},{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\HIGH\\Desktop\\New_Git_INFS\\INFS_Front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnN0ZXBzLWNvbnRlbnQgew0KICBtYXJnaW4tdG9wOiAxNnB4Ow0KICBib3JkZXI6IDFweCBkYXNoZWQgI2U5ZTllOTsNCiAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICBtaW4taGVpZ2h0OiAyMDBweDsNCiAgcGFkZGluZzogMjBweDsNCn0NCg0KLnN0ZXBzLWFjdGlvbiB7DQogIG1hcmdpbi10b3A6IDI0cHg7DQogIHRleHQtYWxpZ246IGVuZDsNCn0NCg=="},{"version":3,"sources":["MDS_import_form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAufA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"MDS_import_form.vue","sourceRoot":"src/views/MDS/MDS_import","sourcesContent":["<template>\r\n  <div id=\"reveal_form\">\r\n    <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n      <a-col :span=\"24\">\r\n        <a-card size=\"small\">\r\n          <a-row :gutter=\"[8, 8]\">\r\n            <a-col :span=\"20\" style=\"margin: 0.2em 0px;\">\r\n              <a-card-meta title=\"เพิ่มรายการนำเข้าวัสดุ/อุปกรณ์\">\r\n                <a-icon\r\n                  slot=\"avatar\"\r\n                  type=\"folder-add\"\r\n                  :style=\"{\r\n                    fontSize: '150%',\r\n                  }\"\r\n                />\r\n              </a-card-meta>\r\n            </a-col>\r\n          </a-row>\r\n          <hr style=\"width:100%\" />\r\n          <br />\r\n          <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"start\">\r\n            <a-col :span=\"24\" :style=\"{ fontSize: '120%' }\">\r\n              <b>ข้อมูลการสั่งซื้อ</b>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>หมายเลขใบรายการ</b> :\r\n            </a-col>\r\n            <a-col :span=\"8\">\r\n              <a-input\r\n                placeholder=\"หมายเลขใบรายการ\"\r\n                v-model=\"PurchaseOrder.purchase_order_code\"\r\n              />\r\n            </a-col>\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>ผู้จัดจำหน่าย</b>\r\n            </a-col>\r\n            <a-col :span=\"8\">\r\n              <a-input\r\n                placeholder=\"ชื่อบริษัท\"\r\n                v-model=\"PurchaseOrder.purchase_order_company\"\r\n              />\r\n            </a-col>\r\n          </a-row>\r\n          <br />\r\n          <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>ยอดชำระ</b> :</a-col\r\n            >\r\n            <a-col :span=\"3\">\r\n              <a-input\r\n                type=\"text\"\r\n                disabled\r\n                v-model=\"PurchaseOrder.purchase_order_payment_amount\"\r\n              />\r\n            </a-col>\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>ภาษี (7%)</b> :\r\n            </a-col>\r\n            <a-col :span=\"3\">\r\n              <a-input\r\n                type=\"text\"\r\n                disabled\r\n                v-model=\"PurchaseOrder.purchase_order_vat_amount\"\r\n              />\r\n            </a-col>\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>ยอดชำระสุทธิ</b> :\r\n            </a-col>\r\n\r\n            <a-col :span=\"3\">\r\n              <a-input\r\n                disabled\r\n                type=\"text\"\r\n                :value=\"\r\n                  parseFloat(PurchaseOrder.purchase_order_vat_amount) +\r\n                  parseFloat(PurchaseOrder.purchase_order_payment_amount)\r\n                    ? parseFloat(PurchaseOrder.purchase_order_vat_amount) +\r\n                      parseFloat(PurchaseOrder.purchase_order_payment_amount)\r\n                    : 0\r\n                \"\r\n              />\r\n            </a-col>\r\n            <a-col :span=\"2\" :style=\"{ textAlign: 'end', margin: '0.2em 0px' }\">\r\n              <b>จำนวน</b> :\r\n            </a-col>\r\n            <a-col :span=\"3\">\r\n              <a-input\r\n                disabled\r\n                type=\"number\"\r\n                min=\"1\"\r\n                :value=\"PurchaseOrder.purchase_suppiles.length\"\r\n              />\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter=\"[8, 8]\">\r\n            <a-col :span=\"24\" :style=\"{ fontSize: '120%' }\">\r\n              <b>รายการวัสดุนำเข้า</b>\r\n            </a-col>\r\n          </a-row>\r\n          <br />\r\n          <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n            <a-col :span=\"24\">\r\n              <a-table\r\n                :columns=\"columns_order_material\"\r\n                :data-source=\"PurchaseOrder.purchase_suppiles\"\r\n                :pagination=\"false\"\r\n                size=\"small\"\r\n                bordered\r\n              >\r\n                <span slot=\"key\" slot-scope=\"text, record, index\">\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    {{ index + 1 }}\r\n                  </div>\r\n                </span>\r\n                <span\r\n                  slot=\"order_material_name\"\r\n                  slot-scope=\"text, record, index\"\r\n                >\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-select\r\n                      show-search\r\n                      v-model=\"\r\n                        PurchaseOrder.purchase_suppiles[index].order_material_id\r\n                      \"\r\n                      placeholder=\"กรอกชื่อวัสดุ\"\r\n                      style=\"width: 100%\"\r\n                      :default-active-first-option=\"false\"\r\n                      :show-arrow=\"false\"\r\n                      :filter-option=\"false\"\r\n                      :not-found-content=\"null\"\r\n                      @search=\"handleSearch\"\r\n                      @change=\"handleChange\"\r\n                    >\r\n                      <a-select-option\r\n                        v-for=\"item in optionMaterial\"\r\n                        :key=\"item.material_id\"\r\n                      >\r\n                        {{ item.material_name }}\r\n                      </a-select-option>\r\n                    </a-select>\r\n                  </div>\r\n                </span>\r\n                <span\r\n                  slot=\"order_material_amount\"\r\n                  slot-scope=\"text, record, index\"\r\n                >\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-input\r\n                      placeholder=\"จำนวนวัสดุ\"\r\n                      v-model=\"\r\n                        PurchaseOrder.purchase_suppiles[index]\r\n                          .order_material_amount\r\n                      \"\r\n                      @change=\"summary()\"\r\n                    />\r\n                  </div>\r\n                </span>\r\n                <span\r\n                  slot=\"order_material_unit\"\r\n                  slot-scope=\"text, record, index\"\r\n                >\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-select\r\n                      style=\"width: 100%\"\r\n                      v-model=\"\r\n                        PurchaseOrder.purchase_suppiles[index].order_material_id\r\n                      \"\r\n                      disabled\r\n                    >\r\n                      <a-select-option :value=\"null\">\r\n                        หน่วยนับ\r\n                      </a-select-option>\r\n                      <a-select-option\r\n                        v-for=\"item in objMaterial\"\r\n                        :key=\"item.key\"\r\n                        :value=\"item.material_id\"\r\n                      >\r\n                        {{ item.unit_name }}\r\n                      </a-select-option>\r\n                    </a-select>\r\n                  </div>\r\n                </span>\r\n                <span\r\n                  slot=\"order_material_price_per_unit\"\r\n                  slot-scope=\"text, record, index\"\r\n                >\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-input\r\n                      placeholder=\"ราคาต่อหน่วย\"\r\n                      v-model=\"\r\n                        PurchaseOrder.purchase_suppiles[index]\r\n                          .order_material_price_per_unit\r\n                      \"\r\n                      @change=\"summary()\"\r\n                    />\r\n                  </div>\r\n                </span>\r\n                <span\r\n                  slot=\"order_material_price\"\r\n                  slot-scope=\"text, record, index\"\r\n                >\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-input\r\n                      disabled\r\n                      placeholder=\"ราคารวมของวัสดุ\"\r\n                      :value=\"\r\n                        parseFloat(\r\n                          PurchaseOrder.purchase_suppiles[index]\r\n                            .order_material_amount\r\n                        ) *\r\n                        parseFloat(\r\n                          PurchaseOrder.purchase_suppiles[index]\r\n                            .order_material_price_per_unit\r\n                        )\r\n                          ? parseFloat(\r\n                              PurchaseOrder.purchase_suppiles[index]\r\n                                .order_material_amount\r\n                            ) *\r\n                            parseFloat(\r\n                              PurchaseOrder.purchase_suppiles[index]\r\n                                .order_material_price_per_unit\r\n                            )\r\n                          : 0\r\n                      \"\r\n                    />\r\n                  </div>\r\n                </span>\r\n                <span slot=\"action\" slot-scope=\"text, record, index\">\r\n                  <div :style=\"{ textAlign: 'center' }\">\r\n                    <a-tooltip placement=\"top\">\r\n                      <template slot=\"title\">\r\n                        <span>ลบข้อมูลวัสดุ</span>\r\n                      </template>\r\n                      <a-button\r\n                        :disabled=\"PurchaseOrder.purchase_suppiles.length == 1\"\r\n                        type=\"danger\"\r\n                        icon=\"close\"\r\n                        @click=\"deleteRecordmaterial(index)\"\r\n                      >\r\n                      </a-button>\r\n                    </a-tooltip>\r\n                  </div>\r\n                </span>\r\n              </a-table>\r\n            </a-col>\r\n          </a-row>\r\n          <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n            <a-col :span=\"20\">\r\n              <a-button\r\n                type=\"dashed\"\r\n                style=\"width:100%\"\r\n                icon=\"plus\"\r\n                @click=\"addRecordmaterial()\"\r\n                >เพิ่มรายการข้อมูล\r\n              </a-button>\r\n            </a-col>\r\n          </a-row>\r\n\r\n          <template slot=\"actions\" class=\"ant-card-actions\">\r\n            <a-row :gutter=\"[8, 8]\" type=\"flex\" justify=\"center\">\r\n              <a-col :span=\"12\" style=\"text-align:start\">\r\n                <a-button type=\"danger\" style=\"width:25%;margin:0px 1.5%\"\r\n                  >ยกเลิก\r\n                </a-button>\r\n              </a-col>\r\n              <a-col :span=\"12\" style=\"text-align:end\">\r\n                <a-button\r\n                  type=\"success\"\r\n                  style=\"width:25%;margin:0px 1.5%\"\r\n                  icon=\"save\"\r\n                  @click=\"SaveRecordmaterial()\"\r\n                  >บันทึกรายการ\r\n                </a-button>\r\n              </a-col>\r\n            </a-row>\r\n          </template>\r\n        </a-card>\r\n      </a-col>\r\n    </a-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nlet timeout;\r\n\r\nfunction fetch(value, callback) {\r\n  if (timeout) {\r\n    clearTimeout(timeout);\r\n    timeout = null;\r\n  }\r\n  function fake() {\r\n    axios\r\n      .post(\"http://localhost:8080/materialRouters/getMaterialOption\", {\r\n        material_name: value,\r\n      })\r\n      .then(function(res) {\r\n        console.log(res);\r\n        const data = res.data.results;\r\n        const optionMaterial = [];\r\n        data.forEach(function(ele) {\r\n          optionMaterial.push({\r\n            material_id: ele.material_id,\r\n            material_name: ele.material_name,\r\n          });\r\n          console.log(optionMaterial);\r\n          callback(optionMaterial);\r\n        });\r\n      })\r\n      .catch(function(error) {\r\n        console.log(error);\r\n      });\r\n  }\r\n  timeout = setTimeout(fake, 300);\r\n}\r\n\r\nexport default {\r\n  name: \"reveal_form\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      optionMaterial: [],\r\n      objMaterial: [],\r\n      indexPurchaseOrder: 2,\r\n      PurchaseOrder: {\r\n        purchase_order_code: null,\r\n        purchase_order_company: null,\r\n        purchase_order_amount: 0,\r\n        purchase_order_payment_amount: 0,\r\n        purchase_order_vat_amount: 0,\r\n        purchase_order_by: this.$store.state.user.user_id,\r\n        purchase_suppiles: [\r\n          {\r\n            key: 1,\r\n            order_material_id: undefined,\r\n            order_material_amount: 0,\r\n            order_material_price_per_unit: 0,\r\n          },\r\n        ],\r\n      },\r\n      columns_order_material: [\r\n        {\r\n          title: \"#\",\r\n          dataIndex: \"key\",\r\n          key: \"key\",\r\n          width: \"3%\",\r\n          scopedSlots: {\r\n            customRender: \"key\",\r\n          },\r\n        },\r\n        {\r\n          title: \"รายการวัสดุ\",\r\n          dataIndex: \"order_material_name\",\r\n          key: \"order_material_name\",\r\n          width: \"15%\",\r\n          scopedSlots: {\r\n            customRender: \"order_material_name\",\r\n          },\r\n        },\r\n        {\r\n          title: \"จำนวน\",\r\n          dataIndex: \"order_material_amount\",\r\n          key: \"order_material_amount\",\r\n          width: \"7%\",\r\n          scopedSlots: {\r\n            customRender: \"order_material_amount\",\r\n          },\r\n        },\r\n        {\r\n          title: \"หน่วยนับ\",\r\n          dataIndex: \"order_material_unit\",\r\n          key: \"order_material_unit\",\r\n          width: \"5%\",\r\n          scopedSlots: {\r\n            customRender: \"order_material_unit\",\r\n          },\r\n        },\r\n        {\r\n          title: \"ราคาต่อหน่วย\",\r\n          dataIndex: \"order_material_price_per_unit\",\r\n          key: \"order_material_price_per_unit\",\r\n          width: \"5%\",\r\n          scopedSlots: {\r\n            customRender: \"order_material_price_per_unit\",\r\n          },\r\n        },\r\n        {\r\n          title: \"ราคารวม (บาท)\",\r\n          dataIndex: \"order_material_price\",\r\n          key: \"order_material_price\",\r\n          width: \"5%\",\r\n          scopedSlots: {\r\n            customRender: \"order_material_price\",\r\n          },\r\n        },\r\n        {\r\n          title: \"\",\r\n          dataIndex: \"action\",\r\n          key: \"action\",\r\n          width: \"5%\",\r\n          scopedSlots: {\r\n            customRender: \"action\",\r\n          },\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    filterOption(input, option) {\r\n      console.log(option);\r\n      return (\r\n        option.componentOptions.children[0].text\r\n          .toUpperCase()\r\n          .indexOf(input.toUpperCase()) >= 0\r\n      );\r\n    },\r\n    addRecordmaterial() {\r\n      this.PurchaseOrder.purchase_suppiles.push({\r\n        key: this.indexPurchaseOrder,\r\n        order_material_id: undefined,\r\n        order_material_amount: 0,\r\n        order_material_price_per_unit: 0,\r\n      });\r\n      this.indexPurchaseOrder++;\r\n    },\r\n    deleteRecordmaterial(index) {\r\n      this.PurchaseOrder.purchase_suppiles.splice(index, 1);\r\n    },\r\n    getMaterial() {\r\n      const self = this;\r\n      axios\r\n        .post(self.$store.state.url + \"/materialRouters/getMaterialOption\", {\r\n          material_name: \"\",\r\n        })\r\n        .then(function(res) {\r\n          console.log(res);\r\n          let data = res.data.results;\r\n          data.forEach(function(ele, index) {\r\n            self.objMaterial.push({\r\n              key: index + 1,\r\n              material_id: ele.material_id,\r\n              unit_name: ele.unit_name,\r\n            });\r\n            console.log(self.objMaterial);\r\n          });\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n    summary() {\r\n      const self = this;\r\n      self.PurchaseOrder.purchase_order_payment_amount = 0;\r\n      self.PurchaseOrder.purchase_order_vat_amount = 0;\r\n      self.PurchaseOrder.purchase_suppiles.forEach((ele) => {\r\n        self.PurchaseOrder.purchase_order_payment_amount +=\r\n          ele.order_material_amount * ele.order_material_price_per_unit;\r\n      });\r\n      self.PurchaseOrder.purchase_order_vat_amount =\r\n        (self.PurchaseOrder.purchase_order_payment_amount * 7) / 100;\r\n    },\r\n    SaveRecordmaterial() {\r\n      const self = this;\r\n      console.log(self.PurchaseOrder.purchase_suppiles);\r\n      axios\r\n        .post(\r\n          self.$store.state.url + \"/purchaseOrderRouters/insertPurchaseOrder\",\r\n          self.PurchaseOrder\r\n        )\r\n        .then(function(res) {\r\n          console.log(res);\r\n          self.$notification[\"success\"]({\r\n            message: \"นำเข้าวัสดุเสร็จสิ้น\",\r\n            duration: 2,\r\n          });\r\n          self.$router.go(-1);\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n          self.$notification[\"error\"]({\r\n            message: \"นำเข้าวัสดุเสร็จสิ้น\",\r\n            duration: 2,\r\n          });\r\n        });\r\n    },\r\n    handleSearch(value) {\r\n      fetch(value, (optionMaterial) => (this.optionMaterial = optionMaterial));\r\n    },\r\n    handleChange(value) {\r\n      console.log(value);\r\n\r\n      fetch(value, (optionMaterial) => (this.optionMaterial = optionMaterial));\r\n    },\r\n  },\r\n  created() {\r\n    this.getMaterial();\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.steps-content {\r\n  margin-top: 16px;\r\n  border: 1px dashed #e9e9e9;\r\n  border-radius: 6px;\r\n  min-height: 200px;\r\n  padding: 20px;\r\n}\r\n\r\n.steps-action {\r\n  margin-top: 24px;\r\n  text-align: end;\r\n}\r\n</style>\r\n"]}]}